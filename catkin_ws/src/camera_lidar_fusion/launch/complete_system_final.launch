<launch>
  <!-- Complete Camera-LiDAR Fusion System - FINAL VERSION -->
  
  <!-- ZED Camera Node (Simple Version) -->
  <node name="zed_camera_node" pkg="camera_lidar_fusion" type="zed_camera_node.py" output="screen" />

  <!-- UniLiDAR Node (REAL) -->
  <node name="unitree_lidar_ros_node" pkg="unitree_lidar_ros" type="unitree_lidar_ros_node" output="screen">
    <param name="port" value="/dev/ttyUSB0" />
    <param name="cloud_topic" value="unilidar/cloud" />
    <param name="cloud_frame" value="unilidar_lidar" />
    <param name="imu_topic" value="unilidar/imu" />
    <param name="imu_frame" value="unilidar_imu" />
  </node>

  <!-- LiDAR Processing Node -->
  <node name="lidar_only_node" pkg="camera_lidar_fusion" type="lidar_only_node.py" output="screen" />

  <!-- TF Static Transform Publisher for LiDAR -->
  <node name="lidar_tf_publisher" pkg="tf2_ros" type="static_transform_publisher" 
        args="0 0 0 0 0 0 base_link unilidar_lidar" />

  <!-- Calibrated LiDAR-Camera Fusion Node -->
  <node name="calibrated_fusion_node" pkg="camera_lidar_fusion" type="calibrated_fusion_node.py" output="screen">
    <!-- Calibration parameters -->
    <param name="lidar_to_camera_x" value="0.0" />
    <param name="lidar_to_camera_y" value="0.0" />
    <param name="lidar_to_camera_z" value="0.1" />
    <param name="camera_fov_horizontal" value="90.0" />
    <param name="camera_fov_vertical" value="60.0" />
  </node>

  <!-- Distance Monitor Node -->
  <node name="distance_monitor_node" pkg="camera_lidar_fusion" type="distance_monitor_node.py" output="screen">
    <param name="warning_distance" value="0.9" />
    <param name="danger_distance" value="0.5" />
  </node>

  <!-- RViz for Visualization -->
  <node name="rviz" pkg="rviz" type="rviz" args="-d $(find camera_lidar_fusion)/config/simple_fusion.rviz" output="screen" />

  <!-- Image View for Camera -->
  <node name="left_image_view" pkg="image_view" type="image_view" output="screen">
    <remap from="image" to="/zed/left/image_raw" />
    <param name="window_name" value="ZED Left Camera" />
  </node>

  <node name="right_image_view" pkg="image_view" type="image_view" output="screen">
    <remap from="image" to="/zed/right/image_raw" />
    <param name="window_name" value="ZED Right Camera" />
  </node>

  <!-- Web Monitor -->
  <node name="web_monitor" pkg="camera_lidar_fusion" type="web_monitor.py" output="screen" />

</launch>
